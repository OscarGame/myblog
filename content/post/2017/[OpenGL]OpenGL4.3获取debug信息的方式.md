---
title: "[OpenGL]OpenGL4.3获取debug信息的方式"
date: "2017-02-04T15:54:40+08:00"
categories:
- OpenGL
tags:
- Graphics
---

Keywords：debug、opengl、调试、message

4.3之前的版本，如果要打印debug信息，通常是调用`glGetError()`函数，从4.3开始，提供了注册回调函数来获取debug message。

#### 示例：

1.Create a callback function to receive the debug messages. The function must conform to a specific prototype described in the OpenGL documentation. For this example, we'll use the following one:

    void debugCallback(GLenum source, GLenum type, GLuint id,GLenum severity, GLsizei length,const GLchar * message, void * param)
    {
        // Convert GLenum parameters to strings
        printf("%s:%s[%s](%d): %s\n", sourceStr, typeStr, severityStr, id, message);
    }

2.Register our callback with OpenGL using glDebugMessageCallback:

    glDebugMessageCallback( debugCallback, NULL );

 

3.Enable all messages, all sources, all levels, and all IDs:

    glDebugMessageControl(GL_DONT_CARE, GL_DONT_CARE, GL_DONT_CARE, 0, NULL, GL_TRUE);


#### 开启或禁用debug消息：

opengl默认是开启了debug的，显示开启方式：

    glEnable(GL_DEBUG_OUTPUT);


##### debugCallback函数的参数类型说明：

<table>
    <thead>
        <tr>
            <th>Source</th>
            <th>Generated By</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>GL_DEBUG_SOURCE_API</td>
            <td>Calls to the OpenGL API</td>
        </tr>
        <tr>
            <td>GL_DEBUG_SOURCE_WINDOW_SYSTEM</td>
            <td>Calls to a window system API</td>
        </tr>
        <tr>
            <td>GL_DEBUG_SOURCE_THIRD_PARTY</td>
            <td>An application associated with OpenGL</td>
        </tr>
        <tr>
            <td>GL_DEBUG_SOURCE_APPLICATION</td>
            <td>This application itself</td>
        </tr>
        <tr>
            <td>GL_DEBUG_SOURCE_OTHER</td>
            <td>Some other source</td>
        </tr>
    </tbody>
</table>



##### The type parameter can have any of the following values:

<table>
    <thead>
        <tr>
            <th>Type</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>GL_DEBUG_TYPE_ERROR</td>
            <td>An error from the OpenGL API.</td>
        </tr>
        <tr>
            <td>GL_DEBUG_TYPE_DEPRECATED_BEHAVIOR</td>
            <td>Behavior that has been deprecated</td>
        </tr>
        <tr>
            <td>GL_DEBUG_TYPE_UNDEFINED_BEHAVIOR</td>
            <td>Undefined behaviour</td>
        </tr>
        <tr>
            <td>GL_DEBUG_TYPE_PORTABILITIY</td>
            <td>Some functionality is not portable.</td>
        </tr>
        <tr>
            <td>GL_DEBUG_TYPE_PERFORMANCE</td>
            <td>Possible performance issues</td>
        </tr>
        <tr>
            <td>GL_DEBUG_TYPE_MARKER</td>
            <td>An annotation</td>
        </tr>
        <tr>
            <td>GL_DEBUG_TYPE_PUSH_GROUP</td>
            <td>Messages related to debug group push.</td>
        </tr>
        <tr>
            <td>GL_DEBUG_TYPE_POP_GROUP</td>
            <td>Messages related to debug group pop.</td>
        </tr>
        <tr>
            <td>GL_DEBUG_TYPE_OTHER</td>
            <td>Other messages</td>
        </tr>
    </tbody>
</table>


##### The severity parameter can have the following values:

<table>
    <thead>
        <tr>
            <th>Severity</th>
            <th>Meaning</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>GL_DEBUG_SEVERITY_HIGH</td>
            <td>Errors or dangerous behaviour</td>
        </tr>
        <tr>
            <td>GL_DEBUG_SEVERITY_MEDIUM</td>
            <td>Major performance warnings, other warnings or use of deprecated functionality.</td>
        </tr>
        <tr>
            <td>GL_DEBUG_SEVERITY_LOW</td>
            <td>Redundant state changes, unimportant undefined behaviour.</td>
        </tr>
        <tr>
            <td>GL_DEBUG_SEVERITY_NOTIFICATION</td>
            <td>A notification, not an error or performance issue.</td>
        </tr>
    </tbody>
</table>

 

#### Debug filter分组

opengl提供了两个函数glPushDebugGroup 和glPopDebugGroup。当在某个位置执行glPushDebugGroup，opengl内部就会将当前的debug filter保存到一个堆栈里面，然后再执行glDebugMessageControl时，不会覆盖之前位置设置的debug filter，直到执行glPopDebugGroup之后。

这两个函数的意义是：如果想让某块代码的debug级别是error，另一个代码的debug级别是warn，那么就可以使用glPushDebugGroup 和glPopDebugGroup来让多个debug级别共存。